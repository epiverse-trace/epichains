<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Projecting infectious disease incidence: a COVID-19 example • epichains</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Projecting infectious disease incidence: a COVID-19 example">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">epichains</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epichains.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/projecting_incidence.html">Projecting infectious disease incidence: a COVID-19 example</a></li>
    <li><a class="dropdown-item" href="../articles/interventions.html">Modelling disease control interventions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling guides and background</h6></li>
    <li><a class="dropdown-item" href="../articles/branching_process_literature.html">Literature on branching process applications</a></li>
    <li><a class="dropdown-item" href="../articles/theoretical_background.html">Theoretical background for epichains</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {epichains}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/epichains/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Projecting infectious disease incidence: a COVID-19 example</h1>
                        <h4 data-toc-skip class="author">James Azam,
Sebastian Funk</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epichains/blob/main/vignettes/projecting_incidence.Rmd" class="external-link"><code>vignettes/projecting_incidence.Rmd</code></a></small>
      <div class="d-none name"><code>projecting_incidence.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Branching processes can be used to project stochastic infectious
disease trends in time provided we can characterize the distribution of
times between successive cases (serial interval), and the distribution
of secondary cases produced by a single individual (offspring
distribution). Such simulations can be achieved in <em>epichains</em>
with the <code><a href="../reference/simulate_chains.html">simulate_chains()</a></code> function and <span class="citation">Pearson et al. (<a href="#ref-pearson2020">2020</a>)</span>, and <span class="citation">Abbott et al. (<a href="#ref-abbott2020">2020</a>)</span> illustrate its application to
COVID-19.</p>
<p>The purpose of this vignette is to use early data on COVID-19 in
South Africa <span class="citation">(<a href="#ref-marivate2020">Marivate and Combrink 2020</a>)</span> to
illustrate how <em>epichains</em> can be used to project an
outbreak.</p>
<p>Let’s load the required packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/epiverse-trace/epichains" class="external-link">"epichains"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org" class="external-link">"lubridate"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Included in <em>epichains</em> is a cleaned time series of the first
15 days of the COVID-19 outbreak in South Africa. This can be loaded
into memory as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid19_sa"</span>, package <span class="op">=</span> <span class="st">"epichains"</span><span class="op">)</span></span></code></pre></div>
<p>We will use the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn><annotation encoding="application/x-tex">5</annotation></semantics></math>
observations for this demonstration. We will assume that all the cases
in that subset are imported and did not infect each other.</p>
<p>Let us subset and view that aspect of the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed_cases</span> <span class="op">&lt;-</span> <span class="va">covid19_sa</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seed_cases</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   date       cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2020-03-05     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2020-03-07     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2020-03-08     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2020-03-09     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2020-03-11     6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setting-up-the-inputs">Setting up the inputs<a class="anchor" aria-label="anchor" href="#setting-up-the-inputs"></a>
</h2>
<p>We will now proceed to set up <code><a href="../reference/simulate_chains.html">simulate_chains()</a></code> for the
simulations.</p>
<div class="section level3">
<h3 id="onset-times">Onset times<a class="anchor" aria-label="anchor" href="#onset-times"></a>
</h3>
<p><code><a href="../reference/simulate_chains.html">simulate_chains()</a></code> requires a vector of seeding times,
<code>t0</code>, for each chain/individual/simulation.</p>
<p>To get this, we will use the observation date of the index case as
the reference and find the difference between the other observed dates
and the reference.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">days_since_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">seed_cases</span><span class="op">$</span><span class="va">date</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">seed_cases</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">days_since_index</span></span>
<span><span class="co">#&gt; [1] 0 2 3 4 6</span></span></code></pre></div>
<p>Using the vector of start times from the time series, we will then
create a corresponding seeding time for each individual, which we’ll
call <code>t0</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">days_since_index</span>, <span class="va">seed_cases</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span></span>
<span><span class="va">t0</span></span>
<span><span class="co">#&gt;  [1] 0 2 3 4 4 4 4 6 6 6 6 6 6</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generation-time">Generation time<a class="anchor" aria-label="anchor" href="#generation-time"></a>
</h3>
<p>In epidemiology, the generation time (also called the generation
interval) is the duration between successive infectious events in a
chain of transmission. Similarly, the serial interval is the duration
between observed symptom onset times between successive cases in a
transmission chain. The generation interval is often hard to observe
because exact times of infection are hard to measure hence, the serial
interval is often used instead. Here, we use the serial interval and
interpret the simulated case data to represent symptom onset.</p>
<p>In this example, we will assume based on COVID-19 literature that the
serial interval, S, is log-normal distributed with parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>4.7</mn></mrow><annotation encoding="application/x-tex">\mu = 4.7</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>2.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 2.9</annotation></semantics></math><span class="citation">(<a href="#ref-pearson2020">Pearson et al.
2020</a>)</span>. The log-normal distribution is commonly used in
epidemiology to characterise quantities such as the serial interval
because it has a large variance and can only be positive-valued <span class="citation">(<a href="#ref-nishiura2007">Nishiura 2007</a>; <a href="#ref-limpert2001">Limpert, Stahel, and Abbt 2001</a>)</span>.</p>
<p>Note that when the distribution is described this way, it means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
are the expected value and standard deviation of the natural logarithm
of the serial interval. Hence, in order to sample the “back-transformed”
measured serial interval with expectation/mean,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[S]</annotation></semantics></math>
and standard deviation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">SD [S]</annotation></semantics></math>,
we can use the following parametrisation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><msup><mi>μ</mi><mn>2</mn></msup><mrow><mo stretchy="false" form="prefix">(</mo><msqrt><mrow><msup><mi>μ</mi><mn>2</mn></msup><mo>+</mo><msup><mi>σ</mi><mn>2</mn></msup></mrow></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>S</mi><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msqrt><mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac displaystyle="true"><msup><mi>σ</mi><mn>2</mn></msup><msup><mi>μ</mi><mn>2</mn></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
E[S] &amp;= \ln \left( \dfrac{\mu^2}{(\sqrt{\mu^2 + \sigma^2}} \right) \\

SD [S] &amp;= \sqrt {\ln \left(1 + \dfrac{\sigma^2}{\mu^2} \right)}
 
\end{align}</annotation></semantics></math></p>
<p>See <a href="https://en.wikipedia.org/wiki/Log-normal_distribution" class="external-link">“log-normal_distribution”
on Wikipedia</a> for a detailed explanation of this parametrisation.</p>
<p>We will now set up the generation time function with the appropriate
inputs. We adopt R’s random lognormal distribution generator
(<code><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm()</a></code>) that takes <code>meanlog</code> and
<code>sdlog</code> as arguments, which we define with the
parametrisation above as <code>log_mean()</code> and
<code>log_sd()</code> respectively and wrap it in the
<code>generation_time_fn()</code> function. Moreover,
<code>generation_time_fn()</code> takes one argument <code>n</code> as
is required by <em>epichains</em> (See
<code><a href="../reference/simulate_chains.html">?epichains::simulate_chains</a></code>), which is further passed to
<code><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm()</a></code> as the first argument to determine the number of
observations to sample (See <code><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">?rlnorm</a></code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">4.7</span></span>
<span><span class="va">sgma</span> <span class="op">&lt;-</span> <span class="fl">2.9</span></span>
<span></span>
<span><span class="va">log_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">mu</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sgma</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">mu</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># log mean</span></span>
<span><span class="va">log_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">sgma</span> <span class="op">/</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># log sd</span></span>
<span></span>
<span><span class="co">#' serial interval function</span></span>
<span><span class="va">generation_time</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n</span>, meanlog <span class="op">=</span> <span class="va">log_mean</span>, sdlog <span class="op">=</span> <span class="va">log_sd</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="offspring-distribution">Offspring distribution<a class="anchor" aria-label="anchor" href="#offspring-distribution"></a>
</h3>
<p>Let us now set up the offspring distribution, that is the
distribution that drives the mechanism behind how individual cases
infect other cases. The appropriate way to model the offspring
distribution is to capture both the population-level transmissibility
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">R0</annotation></semantics></math>)
and the individual-level heterogeneity in transmission
(“superspreading”). The negative binomial distribution is commonly used
in this case <span class="citation">(<a href="#ref-lloyd-smith2005">Lloyd-Smith et al. 2005</a>)</span>.</p>
<p>For this example, we will assume that the offspring distribution is
characterised by a negative binomial with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>u</mi><mo>=</mo><mn>2.5</mn></mrow><annotation encoding="application/x-tex">mu = 2.5</annotation></semantics></math><span class="citation">(<a href="#ref-abbott2020">Abbott et al.
2020</a>)</span> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mn>0.58</mn></mrow><annotation encoding="application/x-tex">size = 0.58</annotation></semantics></math><span class="citation">(<a href="#ref-wang2020">Wang et al.
2020</a>)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">0.58</span></span></code></pre></div>
<p>In this parameterization,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">mu</annotation></semantics></math>
represents the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>,
which is defined as the average number of cases produced by a single
individual in an entirely susceptible population. The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">size</annotation></semantics></math>
represents superspreading, that is, the degree of heterogeneity in
transmission by single individuals.</p>
</div>
<div class="section level3">
<h3 id="simulation-controls">Simulation controls<a class="anchor" aria-label="anchor" href="#simulation-controls"></a>
</h3>
<p>For this example, we will simulate outbreaks that end
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>21</mn><annotation encoding="application/x-tex">21</annotation></semantics></math>
days after the last date of observations in the <code>seed_cases</code>
dataset.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Date to end simulation</span></span>
<span><span class="va">projection_window</span> <span class="op">&lt;-</span> <span class="fl">21</span></span>
<span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">days_since_index</span><span class="op">)</span> <span class="op">+</span> <span class="va">projection_window</span></span>
<span><span class="va">tf</span></span>
<span><span class="co">#&gt; [1] 27</span></span></code></pre></div>
<p><code><a href="../reference/simulate_chains.html">simulate_chains()</a></code> is stochastic, meaning the results are
different every time it is run for the same set of parameters. We will,
therefore, run the simulations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>100</mn><annotation encoding="application/x-tex">100</annotation></semantics></math>
times and aggregate the results.</p>
<p>Let us specify that.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Number of simulations</span></span>
<span><span class="va">sim_rep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre></div>
<p>Lastly, since, we have specified that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mn>0</mn><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R0 &gt; 1</annotation></semantics></math>,
it means the epidemic could potentially grow without end. Hence, we must
specify an end point for the simulations.</p>
<p><code><a href="../reference/simulate_chains.html">simulate_chains()</a></code> provides the
<code>stat_threshold</code> argument for this purpose. Above
<code>stat_threshold</code>, the simulation is cut off. If this value is
not specified, it assumes a value of infinity. Here, we will assume a
maximum chain size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1000</mn><annotation encoding="application/x-tex">1000</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Maximum chain size allowed</span></span>
<span><span class="va">stat_threshold</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modelling-assumptions">Modelling assumptions<a class="anchor" aria-label="anchor" href="#modelling-assumptions"></a>
</h2>
<p>This exercise makes the following simplifying assumptions:</p>
<ol style="list-style-type: decimal">
<li>All cases are observed.</li>
<li>Cases are observed exactly at the time of infection.</li>
<li>There is no reporting delay.</li>
<li>Reporting rate is constant through the course of the epidemic.</li>
<li>No interventions have been implemented.</li>
<li>Population is homogeneous and well-mixed.</li>
</ol>
<p>To summarise the whole set up so far, we are going to simulate each
chain 100 times, projecting cases over 21 days after the first 6 days,
and assuming that no outbreak size exceeds 1000 cases.</p>
</div>
<div class="section level2">
<h2 id="running-the-simulations">Running the simulations<a class="anchor" aria-label="anchor" href="#running-the-simulations"></a>
</h2>
<p>We will use the function <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> to run the simulations
and bind them by rows with <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">dplyr::bind_rows()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">sim_chain_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">sim_rep</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/simulate_chains.html">simulate_chains</a></span><span class="op">(</span></span>
<span>      n_chains <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t0</span><span class="op">)</span>,</span>
<span>      offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>      mu <span class="op">=</span> <span class="va">mu</span>,</span>
<span>      size <span class="op">=</span> <span class="va">size</span>,</span>
<span>      statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>      stat_threshold <span class="op">=</span> <span class="va">stat_threshold</span>,</span>
<span>      generation_time <span class="op">=</span> <span class="va">generation_time</span>,</span>
<span>      t0 <span class="op">=</span> <span class="va">t0</span>,</span>
<span>      tf <span class="op">=</span> <span class="va">tf</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">sim_chain_sizes</span><span class="op">)</span></span></code></pre></div>
<p>Let us view the first few rows of the simulation results.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_output</span><span class="op">)</span></span>
<span><span class="co">#&gt;    chain infector infectee generation      time sim</span></span>
<span><span class="co">#&gt; 14     3        1        2          2  8.123133   1</span></span>
<span><span class="co">#&gt; 15     3        1        3          2  6.842933   1</span></span>
<span><span class="co">#&gt; 16     3        1        4          2  7.260639   1</span></span>
<span><span class="co">#&gt; 17     3        1        5          2 11.244838   1</span></span>
<span><span class="co">#&gt; 18     7        1        2          2  7.022334   1</span></span>
<span><span class="co">#&gt; 19     7        1        3          2 12.182368   1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="post-processing">Post-processing<a class="anchor" aria-label="anchor" href="#post-processing"></a>
</h2>
<p>Now, we will summarise the simulation results.</p>
<p>We want to plot the individual simulated daily time series and show
the median cases per day aggregated over all simulations.</p>
<p>First, we will create the daily time series per simulation by
aggregating the number of cases per day of each simulation.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Daily number of cases for each simulation</span></span>
<span><span class="va">incidence_ts</span> <span class="op">&lt;-</span> <span class="va">sim_output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">day</span>, name <span class="op">=</span> <span class="st">"cases"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">incidence_ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;     sim   day cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     2     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1     6     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1     7     1</span></span></code></pre></div>
<p>Next, we will add a date column to the results of each simulation
set. We will use the date of the first case in the observed data as the
reference start date.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get start date from the observed data</span></span>
<span><span class="va">index_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">seed_cases</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">index_date</span></span>
<span><span class="co">#&gt; [1] "2020-03-05"</span></span>
<span></span>
<span><span class="co"># Add a dates column to each simulation result</span></span>
<span><span class="va">incidence_ts_by_date</span> <span class="op">&lt;-</span> <span class="va">incidence_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">index_date</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;     sim   day cases date      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     0     1 2020-03-05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     2     1 2020-03-06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     3     1 2020-03-07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1     4     4 2020-03-08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1     6     6 2020-03-09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1     7     1 2020-03-10</span></span></code></pre></div>
<p>Now we will aggregate the simulations by day and evaluate the median
daily cases across all simulations.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Median daily number of cases aggregated across all simulations</span></span>
<span><span class="va">median_daily_cases</span> <span class="op">&lt;-</span> <span class="va">incidence_ts_by_date</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>median_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">median_daily_cases</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   date       median_cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2020-03-05            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2020-03-06            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2020-03-07            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2020-03-08            4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2020-03-09            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2020-03-10            8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>We will now plot the individual simulation results alongside the
median of the aggregated results.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># since all simulations may end at a different date, we will find the minimum</span></span>
<span><span class="co"># final date for all simulations for the purposes of visualisation.</span></span>
<span><span class="va">final_date</span> <span class="op">&lt;-</span> <span class="va">incidence_ts_by_date</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>final_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>min_final_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">final_date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">min_final_date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">incidence_ts_by_date</span> <span class="op">&lt;-</span> <span class="va">incidence_ts_by_date</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="va">final_date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">median_daily_cases</span> <span class="op">&lt;-</span> <span class="va">median_daily_cases</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="va">final_date</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">incidence_ts_by_date</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sim</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">median_daily_cases</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">median_cases</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"tomato3"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">covid19_sa</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.75</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">21</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">covid19_sa</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fl">5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fl">0</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>      <span class="fl">30</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fl">0</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>      <span class="fl">30</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">seed_cases</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Daily cases"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="projecting_incidence_files/figure-html/viz-1.png" alt="COVID-19 incidence in South Africa projected over a two week window in 2020. The light gray lines represent the individual simulations, the red line represents the median daily cases across all simulations, the black connected dots represent the observed data, and the dashed vertical line marks the beginning of the projection." width="576"><p class="caption">
COVID-19 incidence in South Africa projected over a two week window in
2020. The light gray lines represent the individual simulations, the red
line represents the median daily cases across all simulations, the black
connected dots represent the observed data, and the dashed vertical line
marks the beginning of the projection.
</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-abbott2020" class="csl-entry">
Abbott, Sam, Joel Hellewell, James Munday, Sebastian Funk, CMMID nCoV
working group, et al. 2020. <span>“The Transmissibility of Novel
Coronavirus in the Early Stages of the 2019-20 Outbreak in Wuhan:
Exploring Initial Point-Source Exposure Sizes and Durations Using
Scenario Analysis.”</span> <em>Wellcome Open Research</em> 5.
</div>
<div id="ref-limpert2001" class="csl-entry">
Limpert, Eckhard, Werner A. Stahel, and Markus Abbt. 2001.
<span>“Log-Normal Distributions Across the Sciences: Keys and
Clues.”</span> <em>BioScience</em> 51 (5): 341–52. <a href="https://doi.org/10.1641/0006-3568(2001)051%5B0341:LNDATS%5D2.0.CO;2" class="external-link">https://doi.org/10.1641/0006-3568(2001)051[0341:LNDATS]2.0.CO;2</a>.
</div>
<div id="ref-lloyd-smith2005" class="csl-entry">
Lloyd-Smith, J. O., S. J. Schreiber, P. E. Kopp, and W. M. Getz. 2005.
<span>“Superspreading and the Effect of Individual Variation on Disease
Emergence.”</span> <em>Nature</em> 438 (7066): 355–59. <a href="https://doi.org/10.1038/nature04153" class="external-link">https://doi.org/10.1038/nature04153</a>.
</div>
<div id="ref-marivate2020" class="csl-entry">
Marivate, Vukosi, and Herkulaas MvE Combrink. 2020. <span>“Use of
Available Data to Inform the COVID-19 Outbreak in South Africa: A Case
Study.”</span> <em>arXiv Preprint arXiv:2004.04813</em>.
</div>
<div id="ref-nishiura2007" class="csl-entry">
Nishiura, Hiroshi. 2007. <span>“Early Efforts in Modeling the Incubation
Period of Infectious Diseases with an Acute Course of Illness.”</span>
<em>Emerging Themes in Epidemiology</em> 4: 1–12. <a href="https://doi.org/10.1186/1742-7622-4-2" class="external-link">https://doi.org/10.1186/1742-7622-4-2</a>.
</div>
<div id="ref-pearson2020" class="csl-entry">
Pearson, Carl A.B., Cari van Schalkwyk, Anna M. Foss, Kathleen M.
O’Reilly, and Juliet R.C. Pulliam. 2020. <span>“Projected Early Spread
of COVID-19 in Africa Through 1 June 2020.”</span>
<em>Eurosurveillance</em> 25 (18): 1–6. <a href="https://doi.org/10.2807/1560-7917.ES.2020.25.18.2000543" class="external-link">https://doi.org/10.2807/1560-7917.ES.2020.25.18.2000543</a>.
</div>
<div id="ref-wang2020" class="csl-entry">
Wang, Liang, Xavier Didelot, Jing Yang, Gary Wong, Yi Shi, Wenjun Liu,
George F. Gao, and Yuhai Bi. 2020. <span>“Inference of Person-to-Person
Transmission of COVID-19 Reveals Hidden Super-Spreading Events During
the Early Outbreak Phase.”</span> <em>Nature Communications</em> 11 (1):
1–6. <a href="https://doi.org/10.1038/s41467-020-18836-4" class="external-link">https://doi.org/10.1038/s41467-020-18836-4</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Azam, Sebastian Funk, Flavio Finger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
