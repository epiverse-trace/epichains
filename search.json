[{"path":"/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to bpmodels","title":"Contributing to bpmodels","text":"outlines propose change bpmodels.","code":""},{"path":"/CONTRIBUTING.html","id":"making-changes","dir":"","previous_headings":"","what":"Making changes","title":"Contributing to bpmodels","text":"want make change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See bug report template. feature request see feature request.","code":""},{"path":"/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Making changes","what":"Pull request process","title":"Contributing to bpmodels","text":"See pull request template Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"epiverse-trace/bpmodels\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Making changes","what":"Code style","title":"Contributing to bpmodels","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to bpmodels","text":"Please note bpmodels released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 bpmodels authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/epichains.html","id":"functionality","dir":"Articles","previous_headings":"","what":"Functionality","title":"Getting started with epichains","text":"epichains currently 4 core functions: simulate_tree(): simulate transmission trees given number chains. simulate_tree_from_pop(): simulate transmission trees given number population size initial immunity. simulate_summary(): simulate vector observed transmission chains sizes/lengths given number chains. likelihood(): estimate likelihood/loglikelihood observing chains given sizes/lengths.","code":""},{"path":[]},{"path":"/articles/epichains.html","id":"classes","dir":"Articles","previous_headings":"Functionality > Object-orientation","what":"Classes","title":"Getting started with epichains","text":"chains_tree, returned simulate_tree() simulate_tree_from_pop() chains_vec, returned simulate_summary(). superclass data.frame attributes tracking aggregation done “time”, “generation” “”. Useful plot method dispatch (see methods section ).","code":""},{"path":"/articles/epichains.html","id":"methods","dir":"Articles","previous_headings":"Functionality > Object-orientation","what":"Methods","title":"Getting started with epichains","text":"print() summary() aggregate()","code":""},{"path":[]},{"path":"/articles/epichains.html","id":"printing-and-summary","dir":"Articles","previous_headings":"Demo","what":"Printing and summary","title":"Getting started with epichains","text":"","code":"library(epichains) # Using `simulate_tree()` tree_from_pois_offspring <- simulate_tree(   nchains = 10,   offspring_dist = \"pois\",   serials_sampler = function(x) 3,   lambda = 2,   stat_max = 10 )  tree_from_pois_offspring # print the output #> `epichains` object #>  #> < tree head (from first known ancestor) > #>  #>    chain_id sim_id ancestor generation time #> 11        1      2        1          2    3 #> 12        2      2        1          2    3 #> 15        4      2        1          2    3 #> 18        5      2        1          2    3 #> 21        6      2        1          2    3 #> 22        8      2        1          2    3 #>  #> < tree tail > #>  #>     chain_id sim_id ancestor generation time #> 100       10     18        9          4    9 #> 77         2     19        8          4    9 #> 101       10     19        9          4    9 #> 78         2     20        8          4    9 #> 102       10     20        9          4    9 #> 79         2     21        8          4    9 #> Chains simulated: 10 #> Number of ancestors (known): 9 #> Number of generations: 7 #> Use `as.data.frame(<object_name>)` to view the full output in the console.  # Using simulate_summary() summary_sim <- simulate_summary(   nchains = 50, offspring_dist = \"pois\",   statistic = \"length\", lambda = 2,   stat_max = 10 )  summary_sim # print the output #> `epichains` object  #>  #>  [1] Inf Inf Inf Inf Inf Inf Inf Inf Inf   2 Inf Inf Inf Inf Inf   2 Inf   2   1 #> [20] Inf Inf Inf Inf Inf   1 Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf #> [39] Inf Inf   2 Inf Inf Inf   1   1 Inf Inf Inf Inf #>  #>  Simulated chain lengths:  #>  #> Max: 2 #> Min: 1  # Using `simulate_tree_from_pop()`  # Simulate with poisson offspring tree_from_pop_pois <- simulate_tree_from_pop(   pop = 1000,   offspring_dist = \"pois\",   offspring_mean = 0.5,   serial_dist = function(x) 3 )  tree_from_pop_pois # print the output #> `epichains` object #>  #> < tree head (from first known ancestor) > #>  #> [1] sim_id     ancestor   generation time       #> <0 rows> (or 0-length row.names) #>  #> < tree tail > #>  #>   sim_id ancestor generation time #> 1      1       NA          1    0 #> Number of ancestors (known): 0 #> Number of generations: 1 #> Use `as.data.frame(<object_name>)` to view the full output in the console.  # Simulate with negative binomial offspring tree_from_pop_nbinom <- simulate_tree_from_pop(   pop = 1000,   offspring_dist = \"nbinom\",   offspring_mean = 0.5,   offspring_disp = 1.1,   serial_dist = function(x) 3 )  tree_from_pop_nbinom # print the output #> `epichains` object #>  #> < tree head (from first known ancestor) > #>  #> [1] sim_id     ancestor   generation time       #> <0 rows> (or 0-length row.names) #>  #> < tree tail > #>  #>   sim_id ancestor generation time #> 1      1       NA          1    0 #> Number of ancestors (known): 0 #> Number of generations: 1 #> Use `as.data.frame(<object_name>)` to view the full output in the console.  # Likelihoods  chain_sizes <- c(1, 1, 4, 7) likelihood(   chains = chain_sizes, statistic = \"size\",   offspring_dist = \"pois\", nsim_obs = 100,   lambda = 0.5 ) #> [1] -8.607196"},{"path":"/articles/epichains.html","id":"aggregation","dir":"Articles","previous_headings":"Demo","what":"Aggregation","title":"Getting started with epichains","text":"","code":"# aggregate by time aggregate(tree_from_pop_pois, \"time\") #>   time cases #> 1    0     1  # aggregate by generation aggregate(tree_from_pop_pois, \"generation\") #>   generation cases #> 1          1     1  # aggregate by both time and generation aggregate(tree_from_pop_pois, \"both\") #> [[1]] #>   time cases #> 1    0     1 #>  #> [[2]] #>   generation cases #> 1          1     1 #>  #> attr(,\"class\") #> [1] \"epichains_aggregate_df\" \"list\"                   #> attr(,\"chain_type\") #> [1] \"chains_tree\" #> attr(,\"aggregated_over\") #> [1] \"both\""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"James M. Azam. Author, maintainer. Zhian N. Kamvar. Contributor. Flavio Finger. Author. Sebastian Funk. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sebastian Funk, Flavio Finger, James M. Azam (2023). epichains: Analysing transmission chain statistics using branching process models, website: https://github.com/epiverse-trace/epichains/","code":"@Manual{,   title = {epichains: Analysing transmission chain statistics using branching process models},   author = {{Sebastian Funk} and {Flavio Finger} and {James M. Azam}},   year = {2023},   url = {https://github.com/epiverse-trace/epichains/}, }"},{"path":"/index.html","id":"id_-packagename--methods-for-simulating-and-analysing-the-size-and-length-of-transmission-chains-from-branching-process-models-","dir":"","previous_headings":"","what":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"{{ packagename }} R package simulate, analyse, visualize size length branching processes given offspring distribution. models often used infectious disease epidemiology, chains represent chains transmission, offspring distribution represents distribution secondary infections caused infected individual. {{ packagename }} re-implements bpmodels providing dedicated data structures allow easy manipulation interoperability existing packages handling transmission chain contact-tracing data. {{ packagename }} developed Centre Mathematical Modelling Infectious Diseases London School Hygiene Tropical Medicine part Epiverse Initiative.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"latest development version {{ packagename }} package can installed via load package, use","code":"# check whether {pak} is installed if(!require(\"pak\")) install.packages(\"pak\") pak::pak(\"{{ gh_repo }}\") library(\"epichains\")"},{"path":"/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"Work progress","code":""},{"path":"/index.html","id":"package-vignettes","dir":"","previous_headings":"","what":"Package vignettes","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"Specific use cases {{ packagename }} can found online documentation package vignettes, “Articles”.","code":""},{"path":"/index.html","id":"reporting-bugs","dir":"","previous_headings":"","what":"Reporting bugs","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"report bug please open issue.","code":""},{"path":"/index.html","id":"contribute","dir":"","previous_headings":"","what":"Contribute","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"welcome contributions enhance package’s functionalities. wish , please follow package contributing guide.","code":""},{"path":"/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of conduct","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"Please note {{ packagename }} project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"/index.html","id":"citing-this-package","dir":"","previous_headings":"","what":"Citing this package","title":"Simulating and Analysing Transmission Chain Statistics Using Branching Process\n    Models","text":"","code":"citation(\"epichains\") #> To cite package epichains in publications use: #>  #>   Sebastian Funk, Flavio Finger, and James M. Azam (2023). epichains: #>   Analysing transmission chain statistics using branching process #>   models, website: https://github.com/epiverse-trace/epichains/ #>  #> A BibTeX entry for LaTeX users is #>  #>   @Manual{, #>     title = {epichains: Analysing transmission chain statistics using branching process models}, #>     author = {{Sebastian Funk} and {Flavio Finger} and {James M. Azam}}, #>     year = {2023}, #>     url = {https://github.com/epiverse-trace/epichains/}, #>   }"},{"path":"/reference/aggregate.epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","title":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","text":"Aggregate cases epichains objects according grouping variable","code":""},{"path":"/reference/aggregate.epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","text":"","code":"# S3 method for epichains aggregate(x, grouping_var = c(\"time\", \"generation\", \"both\"), ...)"},{"path":"/reference/aggregate.epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","text":"x epichains object. grouping_var variable group count . Options include \"time\", \"generation\", \"\". ... arguments passed aggregate.","code":""},{"path":"/reference/aggregate.epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","text":"grouping_var either \"time\" \"generation\", data.frame cases aggregated grouping_var; grouping_var = \"\", list data.frames, first cases time, second cases generations.","code":""},{"path":"/reference/aggregate.epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","text":"James M. Azam","code":""},{"path":"/reference/aggregate.epichains.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate cases in epichains objects according to a grouping variable — aggregate.epichains","text":"","code":"set.seed(123) chains <- simulate_tree(   nchains = 10, statistic = \"size\",   offspring_dist = \"pois\", stat_max = 10, serials_sampler = function(x) 3,   lambda = 2 ) chains #> `epichains` object #>  #> < tree head (from first known ancestor) > #>  #>    chain_id sim_id ancestor generation time #> 11        1      2        1          2    3 #> 12        2      2        1          2    3 #> 15        3      2        1          2    3 #> 17        4      2        1          2    3 #> 21        5      2        1          2    3 #> 25        7      2        1          2    3 #>  #> < tree tail > #>  #>     chain_id sim_id ancestor generation time #> 125       10     17        8          4    9 #> 70         5     18        5          3    6 #> 126       10     18        8          4    9 #> 71         5     19        5          3    6 #> 127       10     19        8          4    9 #> 72         5     20        5          3    6 #> Chains simulated: 10 #> Number of ancestors (known): 8 #> Number of generations: 4 #> Use `as.data.frame(<object_name>)` to view the full output in the console.  # Aggregate cases per time aggregate(chains, grouping_var = \"time\") #>   time cases #> 1    0    10 #> 2    3    24 #> 3    6    64 #> 4    9    29  # Aggregate cases per generation aggregate(chains, grouping_var = \"generation\") #>   generation cases #> 1          1    10 #> 2          2    24 #> 3          3    64 #> 4          4    29  # Aggregate cases per both time and generation aggregate(chains, grouping_var = \"both\") #> [[1]] #>   time cases #> 1    0    10 #> 2    3    24 #> 3    6    64 #> 4    9    29 #>  #> [[2]] #>   generation cases #> 1          1    10 #> 2          2    24 #> 3          3    64 #> 4          4    29 #>  #> attr(,\"class\") #> [1] \"epichains_aggregate_df\" \"list\"                   #> attr(,\"chain_type\") #> [1] \"chains_tree\" #> attr(,\"aggregated_over\") #> [1] \"both\""},{"path":"/reference/check_nchains_valid.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that nchains is greater than 0 and not infinity — check_nchains_valid","title":"Check that nchains is greater than 0 and not infinity — check_nchains_valid","text":"Check nchains greater 0 infinity","code":""},{"path":"/reference/check_nchains_valid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that nchains is greater than 0 and not infinity — check_nchains_valid","text":"","code":"check_nchains_valid(nchains)"},{"path":"/reference/check_nchains_valid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that nchains is greater than 0 and not infinity — check_nchains_valid","text":"nchains Number chains simulate.","code":""},{"path":"/reference/check_offspring_func_valid.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if constructed random number generator for offspring exists — check_offspring_func_valid","title":"Check if constructed random number generator for offspring exists — check_offspring_func_valid","text":"Check constructed random number generator offspring exists","code":""},{"path":"/reference/check_offspring_func_valid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if constructed random number generator for offspring exists — check_offspring_func_valid","text":"","code":"check_offspring_func_valid(roffspring_name)"},{"path":"/reference/check_offspring_func_valid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if constructed random number generator for offspring exists — check_offspring_func_valid","text":"roffspring_name Constructed random offspring sampler: character string corresponding R distribution function (e.g., \"rpois\" Poisson.","code":""},{"path":"/reference/check_offspring_valid.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if offspring argument is specified as a character string — check_offspring_valid","title":"Check if offspring argument is specified as a character string — check_offspring_valid","text":"Check offspring argument specified character string","code":""},{"path":"/reference/check_offspring_valid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if offspring argument is specified as a character string — check_offspring_valid","text":"","code":"check_offspring_valid(offspring_dist)"},{"path":"/reference/check_offspring_valid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if offspring argument is specified as a character string — check_offspring_valid","text":"offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers).","code":""},{"path":"/reference/check_serial_valid.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if the serials_sampler argument is specified as a function — check_serial_valid","title":"Check if the serials_sampler argument is specified as a function — check_serial_valid","text":"Check serials_sampler argument specified function","code":""},{"path":"/reference/check_serial_valid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if the serials_sampler argument is specified as a function — check_serial_valid","text":"","code":"check_serial_valid(serials_sampler)"},{"path":"/reference/check_serial_valid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if the serials_sampler argument is specified as a function — check_serial_valid","text":"serials_sampler serial interval generator function; name user-defined named anonymous function one argument n, representing number serial intervals generate.","code":""},{"path":"/reference/complementary_logprob.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates the complementary log-probability — complementary_logprob","title":"Calculates the complementary log-probability — complementary_logprob","text":"Given x norm, calculates log(1-sum(exp(x)))","code":""},{"path":"/reference/complementary_logprob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates the complementary log-probability — complementary_logprob","text":"","code":"complementary_logprob(x)"},{"path":"/reference/complementary_logprob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates the complementary log-probability — complementary_logprob","text":"x log-probabilities","code":""},{"path":"/reference/complementary_logprob.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates the complementary log-probability — complementary_logprob","text":"value","code":""},{"path":"/reference/complementary_logprob.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculates the complementary log-probability — complementary_logprob","text":"Sebastian Funk","code":""},{"path":"/reference/construct_offspring_ll_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct name of analytical function for estimating loglikelihood of\noffspring — construct_offspring_ll_name","title":"Construct name of analytical function for estimating loglikelihood of\noffspring — construct_offspring_ll_name","text":"Construct name analytical function estimating loglikelihood offspring","code":""},{"path":"/reference/construct_offspring_ll_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct name of analytical function for estimating loglikelihood of\noffspring — construct_offspring_ll_name","text":"","code":"construct_offspring_ll_name(offspring_dist, chain_statistic)"},{"path":"/reference/construct_offspring_ll_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct name of analytical function for estimating loglikelihood of\noffspring — construct_offspring_ll_name","text":"offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers).","code":""},{"path":"/reference/construct_offspring_ll_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct name of analytical function for estimating loglikelihood of\noffspring — construct_offspring_ll_name","text":"analytical offspring likelihood function","code":""},{"path":"/reference/covid19_sa.html","id":null,"dir":"Reference","previous_headings":"","what":"COVID-19 Data Repository for South Africa — covid19_sa","title":"COVID-19 Data Repository for South Africa — covid19_sa","text":"aggregated subset COVID-19 Data Repository South Africa created, maintained hosted Data Science Social Impact research group, led Dr. Vukosi Marivate.","code":""},{"path":"/reference/covid19_sa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COVID-19 Data Repository for South Africa — covid19_sa","text":"","code":"covid19_sa"},{"path":[]},{"path":"/reference/covid19_sa.html","id":"covid-sa","dir":"Reference","previous_headings":"","what":"covid19_sa","title":"COVID-19 Data Repository for South Africa — covid19_sa","text":"data frame 19 rows 2 columns: date Date case reported cases Number cases","code":""},{"path":"/reference/covid19_sa.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"COVID-19 Data Repository for South Africa — covid19_sa","text":"https://github.com/dsfsi/covid19za details data-raw/covid19_sa.R.","code":""},{"path":"/reference/covid19_sa.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"COVID-19 Data Repository for South Africa — covid19_sa","text":"data originally provided linelist subsetted cleaned data-raw/covid19_sa.R.","code":""},{"path":"/reference/dborel.html","id":null,"dir":"Reference","previous_headings":"","what":"Density of the Borel distribution — dborel","title":"Density of the Borel distribution — dborel","text":"Density Borel distribution","code":""},{"path":"/reference/dborel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density of the Borel distribution — dborel","text":"","code":"dborel(x, mu, log = FALSE)"},{"path":"/reference/dborel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density of the Borel distribution — dborel","text":"x Vector integers. mu mu parameter. log Logical; TRUE, probabilities p given log(p).","code":""},{"path":"/reference/dborel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density of the Borel distribution — dborel","text":"Probability mass.","code":""},{"path":"/reference/dborel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Density of the Borel distribution — dborel","text":"Sebastian Funk","code":""},{"path":"/reference/epichains-package.html","id":null,"dir":"Reference","previous_headings":"","what":"epichains: Simulating and Analysing Transmission Chain Statistics Using Branching Process Models — epichains-package","title":"epichains: Simulating and Analysing Transmission Chain Statistics Using Branching Process Models — epichains-package","text":"Provides methods simulate analyse size length branching processes arbitrary offspring distribution. can used, example, analyse distribution chain sizes length infectious disease outbreaks, discussed Farrington et al. (2003) doi:10.1093/biostatistics/4.2.279 .","code":""},{"path":[]},{"path":"/reference/epichains-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"epichains: Simulating and Analysing Transmission Chain Statistics Using Branching Process Models — epichains-package","text":"Maintainer: James M. Azam james.azam@lshtm.ac.uk (ORCID) Authors: Flavio Finger flavio.finger@epicentre.msf.org (ORCID) Sebastian Funk sebastian.funk@lshtm.ac.uk (ORCID) contributors: Zhian N. Kamvar zkamvar@gmail.com (ORCID) [contributor]","code":""},{"path":"/reference/format.epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"Format method for epichains class — format.epichains","title":"Format method for epichains class — format.epichains","text":"Format method epichains class","code":""},{"path":"/reference/format.epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format method for epichains class — format.epichains","text":"","code":"# S3 method for epichains format(x, ...)"},{"path":"/reference/format.epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format method for epichains class — format.epichains","text":"x epichains object ... arguments passed methods","code":""},{"path":"/reference/format.epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format method for epichains class — format.epichains","text":"Invisibly returns epichains. Called printing side-effects.","code":""},{"path":"/reference/format.epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Format method for epichains class — format.epichains","text":"James M. Azam","code":""},{"path":"/reference/gborel_size_ll.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of the size of chains with gamma-Borel offspring distribution — gborel_size_ll","title":"Likelihood of the size of chains with gamma-Borel offspring distribution — gborel_size_ll","text":"Likelihood size chains gamma-Borel offspring distribution","code":""},{"path":"/reference/gborel_size_ll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of the size of chains with gamma-Borel offspring distribution — gborel_size_ll","text":"","code":"gborel_size_ll(x, size, prob, mu)"},{"path":"/reference/gborel_size_ll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of the size of chains with gamma-Borel offspring distribution — gborel_size_ll","text":"x vector sizes size dispersion parameter (often called k ecological applications) prob probability success (parameterisation prob, see also NegBinomial) mu mean parameter","code":""},{"path":"/reference/gborel_size_ll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of the size of chains with gamma-Borel offspring distribution — gborel_size_ll","text":"log-likelihood values","code":""},{"path":"/reference/gborel_size_ll.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood of the size of chains with gamma-Borel offspring distribution — gborel_size_ll","text":"Sebastian Funk","code":""},{"path":"/reference/geom_length_ll.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of the length of chains with geometric offspring distribution — geom_length_ll","title":"Likelihood of the length of chains with geometric offspring distribution — geom_length_ll","text":"Likelihood length chains geometric offspring distribution","code":""},{"path":"/reference/geom_length_ll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of the length of chains with geometric offspring distribution — geom_length_ll","text":"","code":"geom_length_ll(x, prob)"},{"path":"/reference/geom_length_ll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of the length of chains with geometric offspring distribution — geom_length_ll","text":"x vector sizes prob probability geometric distribution mean 1/prob","code":""},{"path":"/reference/geom_length_ll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of the length of chains with geometric offspring distribution — geom_length_ll","text":"log-likelihood values","code":""},{"path":"/reference/geom_length_ll.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood of the length of chains with geometric offspring distribution — geom_length_ll","text":"Sebastian Funk","code":""},{"path":"/reference/get_offspring_func.html","id":null,"dir":"Reference","previous_headings":"","what":"Get offspring sampling function that takes into account susceptible\ndepletion — get_offspring_func","title":"Get offspring sampling function that takes into account susceptible\ndepletion — get_offspring_func","text":"Get offspring sampling function takes account susceptible depletion","code":""},{"path":"/reference/get_offspring_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get offspring sampling function that takes into account susceptible\ndepletion — get_offspring_func","text":"","code":"get_offspring_func(   offspring_dist,   n,   susc,   pop,   mean_offspring,   disp_offspring = NULL )"},{"path":"/reference/get_offspring_func.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get offspring sampling function that takes into account susceptible\ndepletion — get_offspring_func","text":"offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers). n Number items sample susc Susceptible population size (calculated inside simulate_tree_from_pop  pop - initial_immune) pop susceptible population.","code":""},{"path":"/reference/get_offspring_func.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get offspring sampling function that takes into account susceptible\ndepletion — get_offspring_func","text":"offspring sampling function","code":""},{"path":"/reference/get_statistic_func.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a function for calculating chain statistics — get_statistic_func","title":"Return a function for calculating chain statistics — get_statistic_func","text":"Return function calculating chain statistics","code":""},{"path":"/reference/get_statistic_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a function for calculating chain statistics — get_statistic_func","text":"","code":"get_statistic_func(chain_statistic)"},{"path":"/reference/get_statistic_func.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a function for calculating chain statistics — get_statistic_func","text":"function calculating chain statistics","code":""},{"path":"/reference/head.epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"head method for epichains class — head.epichains","title":"head method for epichains class — head.epichains","text":"head method epichains class","code":""},{"path":"/reference/head.epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"head method for epichains class — head.epichains","text":"","code":"# S3 method for epichains head(x, ...)"},{"path":"/reference/head.epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"head method for epichains class — head.epichains","text":"x epichains object ... arguments passed methods","code":""},{"path":"/reference/head.epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"head method for epichains class — head.epichains","text":"object class data.frame","code":""},{"path":"/reference/head.epichains.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"head method for epichains class — head.epichains","text":"returns top rows epichains object. Note object originally sorted sim_id ancestor first unknown ancestors (NA) dropped printing method. view full output, use .data.frame(<object_name>).","code":""},{"path":"/reference/head.epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"head method for epichains class — head.epichains","text":"James M. Azam","code":""},{"path":"/reference/is_chains_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if an epichains object has the chains_summary attribute — is_chains_summary","title":"Check if an epichains object has the chains_summary attribute — is_chains_summary","text":"Check epichains object chains_summary attribute","code":""},{"path":"/reference/is_chains_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if an epichains object has the chains_summary attribute — is_chains_summary","text":"","code":"is_chains_summary(x)"},{"path":"/reference/is_chains_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if an epichains object has the chains_summary attribute — is_chains_summary","text":"x epichains object","code":""},{"path":"/reference/is_chains_summary.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Check if an epichains object has the chains_summary attribute — is_chains_summary","text":"James M. Azam","code":""},{"path":"/reference/is_chains_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if an epichains object has the chains_tree attribute — is_chains_tree","title":"Check if an epichains object has the chains_tree attribute — is_chains_tree","text":"Check epichains object chains_tree attribute","code":""},{"path":"/reference/is_chains_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if an epichains object has the chains_tree attribute — is_chains_tree","text":"","code":"is_chains_tree(x)"},{"path":"/reference/is_chains_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if an epichains object has the chains_tree attribute — is_chains_tree","text":"x epichains object","code":""},{"path":"/reference/is_chains_tree.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Check if an epichains object has the chains_tree attribute — is_chains_tree","text":"James M. Azam","code":""},{"path":"/reference/is_epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"Reports whether x is an epichains object — is_epichains","title":"Reports whether x is an epichains object — is_epichains","text":"Reports whether x epichains object","code":""},{"path":"/reference/is_epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reports whether x is an epichains object — is_epichains","text":"","code":"is_epichains(x)"},{"path":"/reference/is_epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reports whether x is an epichains object — is_epichains","text":"x R object","code":""},{"path":"/reference/is_epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reports whether x is an epichains object — is_epichains","text":"logical, TRUE object epichains FALSE otherwise","code":""},{"path":"/reference/is_epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Reports whether x is an epichains object — is_epichains","text":"James M. Azam","code":""},{"path":"/reference/is_epichains_aggregate_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Reports whether x is an ","title":"Reports whether x is an ","text":"Reports whether x \"epichains_aggregate_df\" object","code":""},{"path":"/reference/is_epichains_aggregate_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reports whether x is an ","text":"","code":"is_epichains_aggregate_df(x)"},{"path":"/reference/is_epichains_aggregate_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reports whether x is an ","text":"x epichains object","code":""},{"path":"/reference/is_epichains_aggregate_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reports whether x is an ","text":"logical, TRUE object epichains_aggregate_df FALSE otherwise","code":""},{"path":"/reference/is_epichains_aggregate_df.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Reports whether x is an ","text":"James M. Azam","code":""},{"path":"/reference/likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the (log) likelihood for observed branching processes — likelihood","title":"Estimate the (log) likelihood for observed branching processes — likelihood","text":"Estimate (log) likelihood observed branching processes","code":""},{"path":"/reference/likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the (log) likelihood for observed branching processes — likelihood","text":"","code":"likelihood(   chains,   statistic = c(\"size\", \"length\"),   offspring_dist,   nsim_obs,   log = TRUE,   obs_prob = 1,   stat_max = Inf,   exclude = NULL,   individual = FALSE,   ... )"},{"path":"/reference/likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the (log) likelihood for observed branching processes — likelihood","text":"chains Vector sizes/lengths transmission chains. statistic String; Statistic calculate. Can one : \"size\": total number offspring. \"length\": total number ancestors. offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers). nsim_obs Number simulations likelihood approximated imperfect observations. log Logical; results log-transformed? (Defaults TRUE). obs_prob Observation probability (assumed constant) stat_max cut chain statistic (size/length) computed. Results specified value, set Inf. exclude vector indices sizes/lengths exclude likelihood calculation. individual TRUE, vector individual (log)likelihood contributions returned rather sum. ... Parameters offspring distribution.","code":""},{"path":"/reference/likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the (log) likelihood for observed branching processes — likelihood","text":"log-likelihood, log = TRUE (default) vector log-likelihoods, log = TRUE (default) obs_prob < 1, list individual log-likelihood contributions, log = TRUE (default) individual = TRUE. else raw likelihoods, vector likelihoods","code":""},{"path":[]},{"path":"/reference/likelihood.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate the (log) likelihood for observed branching processes — likelihood","text":"Sebastian Funk","code":""},{"path":"/reference/likelihood.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate the (log) likelihood for observed branching processes — likelihood","text":"","code":"# example of observed chain sizes chain_sizes <- c(1, 1, 4, 7) likelihood(   chains = chain_sizes, statistic = \"size\",   offspring_dist = \"pois\", nsim_obs = 100, lambda = 0.5 ) #> [1] -8.607196"},{"path":"/reference/nbinom_size_ll.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of the size of chains with Negative-Binomial offspring\ndistribution — nbinom_size_ll","title":"Likelihood of the size of chains with Negative-Binomial offspring\ndistribution — nbinom_size_ll","text":"Likelihood size chains Negative-Binomial offspring distribution","code":""},{"path":"/reference/nbinom_size_ll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of the size of chains with Negative-Binomial offspring\ndistribution — nbinom_size_ll","text":"","code":"nbinom_size_ll(x, size, prob, mu)"},{"path":"/reference/nbinom_size_ll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of the size of chains with Negative-Binomial offspring\ndistribution — nbinom_size_ll","text":"x vector sizes size dispersion parameter (often called k ecological applications) prob probability success (parameterisation prob, see also NegBinomial) mu mean parameter","code":""},{"path":"/reference/nbinom_size_ll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of the size of chains with Negative-Binomial offspring\ndistribution — nbinom_size_ll","text":"log-likelihood values","code":""},{"path":"/reference/nbinom_size_ll.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood of the size of chains with Negative-Binomial offspring\ndistribution — nbinom_size_ll","text":"Sebastian Funk","code":""},{"path":"/reference/offspring_ll.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of the length of chains with generic offspring distribution — offspring_ll","title":"Likelihood of the length of chains with generic offspring distribution — offspring_ll","text":"likelihoods calculated crude approximation using simulated chains linearly approximating missing values empirical cumulative distribution function (ecdf).","code":""},{"path":"/reference/offspring_ll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of the length of chains with generic offspring distribution — offspring_ll","text":"","code":"offspring_ll(   chains,   offspring_dist,   statistic,   nsim_offspring = 100,   log = TRUE,   ... )"},{"path":"/reference/offspring_ll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of the length of chains with generic offspring distribution — offspring_ll","text":"chains Vector sizes/lengths offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers). statistic String; Statistic calculate. Can one : \"size\": total number offspring. \"length\": total number ancestors. nsim_offspring Number simulations offspring distribution approximating statistic (size/length) distribution log Logical; results log-transformed? (Defaults TRUE). ... parameters pass simulate_tree","code":""},{"path":"/reference/offspring_ll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of the length of chains with generic offspring distribution — offspring_ll","text":"log = TRUE (default), log-likelihood values, else raw likelihoods","code":""},{"path":"/reference/offspring_ll.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood of the length of chains with generic offspring distribution — offspring_ll","text":"Sebastian Funk","code":""},{"path":"/reference/pois_length_ll.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of the length of chains with Poisson offspring distribution — pois_length_ll","title":"Likelihood of the length of chains with Poisson offspring distribution — pois_length_ll","text":"Likelihood length chains Poisson offspring distribution","code":""},{"path":"/reference/pois_length_ll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of the length of chains with Poisson offspring distribution — pois_length_ll","text":"","code":"pois_length_ll(x, lambda)"},{"path":"/reference/pois_length_ll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of the length of chains with Poisson offspring distribution — pois_length_ll","text":"x vector sizes lambda rate Poisson distribution","code":""},{"path":"/reference/pois_length_ll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of the length of chains with Poisson offspring distribution — pois_length_ll","text":"log-likelihood values","code":""},{"path":"/reference/pois_length_ll.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood of the length of chains with Poisson offspring distribution — pois_length_ll","text":"Sebastian Funk","code":""},{"path":"/reference/pois_size_ll.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of the size of chains with Poisson offspring distribution — pois_size_ll","title":"Likelihood of the size of chains with Poisson offspring distribution — pois_size_ll","text":"Likelihood size chains Poisson offspring distribution","code":""},{"path":"/reference/pois_size_ll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of the size of chains with Poisson offspring distribution — pois_size_ll","text":"","code":"pois_size_ll(x, lambda)"},{"path":"/reference/pois_size_ll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of the size of chains with Poisson offspring distribution — pois_size_ll","text":"x vector sizes lambda rate Poisson distribution","code":""},{"path":"/reference/pois_size_ll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of the size of chains with Poisson offspring distribution — pois_size_ll","text":"log-likelihood values","code":""},{"path":"/reference/pois_size_ll.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood of the size of chains with Poisson offspring distribution — pois_size_ll","text":"Sebastian Funk","code":""},{"path":"/reference/print.epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an epichains object — print.epichains","title":"Print an epichains object — print.epichains","text":"Print epichains object","code":""},{"path":"/reference/print.epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an epichains object — print.epichains","text":"","code":"# S3 method for epichains print(x, ...)"},{"path":"/reference/print.epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print an epichains object — print.epichains","text":"x epichains object. ... parameters passed print().","code":""},{"path":"/reference/print.epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print an epichains object — print.epichains","text":"Invisibly returns epichains. Called side-effects.","code":""},{"path":"/reference/print.epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print an epichains object — print.epichains","text":"James M. Azam","code":""},{"path":"/reference/rbinom_size.html","id":null,"dir":"Reference","previous_headings":"","what":"Samples size (the number of trials) of a binomial distribution — rbinom_size","title":"Samples size (the number of trials) of a binomial distribution — rbinom_size","text":"Samples size parameter binomial distribution fixed x (number successes) p (success probability)","code":""},{"path":"/reference/rbinom_size.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Samples size (the number of trials) of a binomial distribution — rbinom_size","text":"","code":"rbinom_size(n, x, prob)"},{"path":"/reference/rbinom_size.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Samples size (the number of trials) of a binomial distribution — rbinom_size","text":"n number samples generate x number successes prob probability success","code":""},{"path":"/reference/rbinom_size.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Samples size (the number of trials) of a binomial distribution — rbinom_size","text":"sampled sizes","code":""},{"path":"/reference/rbinom_size.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Samples size (the number of trials) of a binomial distribution — rbinom_size","text":"Sebastian Funk","code":""},{"path":"/reference/rborel.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate random numbers from the Borel distribution — rborel","title":"Generate random numbers from the Borel distribution — rborel","text":"Random numbers generated simulating Poisson branching process","code":""},{"path":"/reference/rborel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate random numbers from the Borel distribution — rborel","text":"","code":"rborel(n, mu, infinite = Inf)"},{"path":"/reference/rborel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate random numbers from the Borel distribution — rborel","text":"n Number random variates generate. mu mu parameter. infinite number treat infinite; simulations stopped number reached","code":""},{"path":"/reference/rborel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate random numbers from the Borel distribution — rborel","text":"Vector random numbers","code":""},{"path":"/reference/rborel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generate random numbers from the Borel distribution — rborel","text":"Sebastian Funk","code":""},{"path":"/reference/rgen_length.html","id":null,"dir":"Reference","previous_headings":"","what":"Samples chain lengths with given observation probabilities — rgen_length","title":"Samples chain lengths with given observation probabilities — rgen_length","text":"Samples length transmission chain individual element observed binomial probability parameters n (number successes) p (success probability)","code":""},{"path":"/reference/rgen_length.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Samples chain lengths with given observation probabilities — rgen_length","text":"","code":"rgen_length(n, x, prob)"},{"path":"/reference/rgen_length.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Samples chain lengths with given observation probabilities — rgen_length","text":"n number samples generate x observed chain lengths prob probability observation","code":""},{"path":"/reference/rgen_length.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Samples chain lengths with given observation probabilities — rgen_length","text":"sampled lengths","code":""},{"path":"/reference/rgen_length.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Samples chain lengths with given observation probabilities — rgen_length","text":"Sebastian Funk","code":""},{"path":"/reference/rnbinom_mean_disp.html","id":null,"dir":"Reference","previous_headings":"","what":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","title":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","text":"Negative binomial random numbers parametrized terms mean dispersion coefficient","code":""},{"path":"/reference/rnbinom_mean_disp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","text":"","code":"rnbinom_mean_disp(n, mn, disp)"},{"path":"/reference/rnbinom_mean_disp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","text":"n number samples draw mn mean distribution disp dispersion coefficient (var/mean)","code":""},{"path":"/reference/rnbinom_mean_disp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","text":"vector containing random numbers","code":""},{"path":"/reference/rnbinom_mean_disp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","text":"Flavio Finger","code":""},{"path":"/reference/rnbinom_mean_disp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Negative binomial random numbers parametrized\nin terms of mean and dispersion coefficient — rnbinom_mean_disp","text":"","code":"rnbinom_mean_disp(n = 5, mn = 4, disp = 2) #> [1] 2 4 4 4 5"},{"path":"/reference/simulate_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a summary of the transmission chain statistic — simulate_summary","title":"Simulate a summary of the transmission chain statistic — simulate_summary","text":"Simulate summary transmission chain statistic","code":""},{"path":"/reference/simulate_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a summary of the transmission chain statistic — simulate_summary","text":"","code":"simulate_summary(   nchains,   statistic = c(\"size\", \"length\"),   offspring_dist,   stat_max = Inf,   ... )"},{"path":"/reference/simulate_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a summary of the transmission chain statistic — simulate_summary","text":"nchains Number chains simulate. statistic String; Statistic calculate. Can one : \"size\": total number offspring. \"length\": total number ancestors. offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers). stat_max cut chain statistic (size/length) computed. Results specified value, set Inf. ... Parameters offspring distribution required R.","code":""},{"path":"/reference/simulate_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a summary of the transmission chain statistic — simulate_summary","text":"","code":"simulate_summary(   nchains = 10, statistic = \"size\", offspring_dist = \"pois\",   stat_max = 10, lambda = 2 ) #> `epichains` object  #>  #>  [1] Inf Inf Inf   1 Inf   2 Inf Inf Inf   1 #>  #>  Simulated chain sizes:  #>  #> Max: 2 #> Min: 1"},{"path":"/reference/simulate_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"Simulate tree infections serial offspring distributions","code":""},{"path":"/reference/simulate_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"","code":"simulate_tree(   nchains,   statistic = c(\"size\", \"length\"),   offspring_dist,   stat_max = Inf,   serials_sampler,   t0 = 0,   tf = Inf,   ... )"},{"path":"/reference/simulate_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"nchains Number chains simulate. statistic String; Statistic calculate. Can one : \"size\": total number offspring. \"length\": total number ancestors. offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers). stat_max cut chain statistic (size/length) computed. Results specified value, set value. Defaults Inf. serials_sampler serial interval generator function; name user-defined named anonymous function one argument n, representing number serial intervals generate. t0 Start time (serial interval given); either single value vector length nchains (number simulations) initial times. Defaults 0. tf End time (serial interval given). ... Parameters offspring distribution required R.","code":""},{"path":"/reference/simulate_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"epichains object, basically data.frame columns chain_id (chain ID), sim_id (unique ID within simulation individual element chain), ancestor (ID ancestor element), generation, time (infection)","code":""},{"path":"/reference/simulate_tree.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"simulate_tree() simulates branching process form: WIP","code":""},{"path":[]},{"path":"/reference/simulate_tree.html","id":"assumptions-disambiguation","dir":"Reference","previous_headings":"","what":"Assumptions/disambiguation","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"epidemiology, generation interval duration successive infectious events chain transmission. Similarly, serial interval duration observed symptom onset times successive cases transmission chain. generation interval often hard observe exact times infection hard measure hence, serial interval often used instead . , use serial interval represent normally called generation interval, , time successive cases. See References literature subject.","code":""},{"path":"/reference/simulate_tree.html","id":"specifying-serials-sampler-in-simulate-tree-","dir":"Reference","previous_headings":"","what":"Specifying serials_sampler in simulate_tree()","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"serials_sampler must specified named anonymous/inline/unnamed function # nolint one argument. example, assuming want specify serial interval generator random log-normally distributed variable meanlog = 0.58 sdlog = 1.58, define named function, call \"serial_interval\", one argument representing number serial intervals sample: serial_interval <- function(n){rlnorm(n, 0.58, 1.38)}, assign name function serials_sampler simulate_tree() like simulate_tree(..., serials_sampler = serial_interval), ... arguments simulate_tree(). Alternatively, assign anonymous function serials_sampler simulate_tree() call like simulate_tree(..., serials_sampler = function(n){rlnorm(n, 0.58, 1.38)}), #nolint ... arguments simulate_tree().","code":""},{"path":"/reference/simulate_tree.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"Lehtinen S, Ashcroft P, Bonhoeffer S. relationship serial interval, infectiousness profile generation time. J R Soc Interface. 2021 Jan;18(174):20200756. doi: 10.1098/rsif.2020.0756. Epub 2021 Jan 6. PMID: 33402022; PMCID: PMC7879757. Fine PE. interval successive cases infectious disease. J Epidemiol. 2003 Dec 1;158(11):1039-47. doi: 10.1093/aje/kwg251. PMID: 14630599.","code":""},{"path":[]},{"path":"/reference/simulate_tree.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"James M. Azam, Sebastian Funk","code":""},{"path":"/reference/simulate_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a tree of infections with a serial and offspring distributions — simulate_tree","text":"","code":"set.seed(123) chains <- simulate_tree(   nchains = 10, statistic = \"size\",   offspring_dist = \"pois\", stat_max = 10, serials_sampler = function(x) 3,   lambda = 2 )"},{"path":"/reference/simulate_tree_from_pop.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"Simulate tree infections initial susceptible population initial immunity","code":""},{"path":"/reference/simulate_tree_from_pop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"","code":"simulate_tree_from_pop(   pop,   offspring_dist = c(\"pois\", \"nbinom\"),   offspring_mean,   offspring_disp,   serial_dist,   initial_immune = 0,   t0 = 0,   tf = Inf )"},{"path":"/reference/simulate_tree_from_pop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"pop susceptible population. offspring_dist Offspring distribution: character string corresponding R distribution function (e.g., \"pois\" Poisson, rpois R function generate Poisson random numbers). offspring_mean average number secondary cases case. R0. offspring_disp dispersion parameter number secondary cases. Ignored offspring == \"pois\". Must > 1 avoid division 0 calculating size. See details ?rnbinom details parameterisation Ecology. serial_dist serial interval. function takes one parameter (n), number serial intervals randomly sample. Value must >= 0. initial_immune number initial immunes population. t0 Start time; Defaults 0. tf End time; Defaults Inf.","code":""},{"path":"/reference/simulate_tree_from_pop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"data frame columns time, id (unique ID individual element chain), ancestor (ID ancestor element), generation.","code":""},{"path":"/reference/simulate_tree_from_pop.html","id":"offspring-distributions","dir":"Reference","previous_headings":"","what":"Offspring distributions","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"Currently \"pois\" & \"nbinom\" supported. Internally truncated distributions used avoid infecting people susceptibles available. poisson model parametrised : lamda = offspring_mean * pop - initial_immune / pop negative binomial model parametrised : mu = offspring_mean * pop - initial immune / pop, size = mu / (offspring_disp - 1). offspring_disp must greater 1. simulate_tree_from_pop() couple key different simulate_tree(): maximal chain statistic limited pop instead stat_max (simulate_tree()), can handle implemented offspring distributions (\"pois\" \"nbinom\").","code":""},{"path":"/reference/simulate_tree_from_pop.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"Flavio Finger James M. Azam","code":""},{"path":"/reference/simulate_tree_from_pop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a tree of infections from an initial susceptible population\nwith initial immunity — simulate_tree_from_pop","text":"","code":"# Simulate with poisson offspring simulate_tree_from_pop(   pop = 100, offspring_dist = \"pois\",   offspring_mean = 0.5, serial_dist = function(x) 3 ) #> `epichains` object #>  #> < tree head (from first known ancestor) > #>  #> [1] sim_id     ancestor   generation time       #> <0 rows> (or 0-length row.names) #>  #> < tree tail > #>  #>   sim_id ancestor generation time #> 1      1       NA          1    0 #> Number of ancestors (known): 0 #> Number of generations: 1 #> Use `as.data.frame(<object_name>)` to view the full output in the console.  # Simulate with negative binomial offspring simulate_tree_from_pop(   pop = 100, offspring_dist = \"nbinom\",   offspring_mean = 0.5, offspring_disp = 1.1, serial_dist = function(x) 3 ) #> `epichains` object #>  #> < tree head (from first known ancestor) > #>  #> [1] sim_id     ancestor   generation time       #> <0 rows> (or 0-length row.names) #>  #> < tree tail > #>  #>   sim_id ancestor generation time #> 1      1       NA          1    0 #> Number of ancestors (known): 0 #> Number of generations: 1 #> Use `as.data.frame(<object_name>)` to view the full output in the console."},{"path":"/reference/summary.epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for epichains class — summary.epichains","title":"Summary method for epichains class — summary.epichains","text":"Summary method epichains class","code":""},{"path":"/reference/summary.epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for epichains class — summary.epichains","text":"","code":"# S3 method for epichains summary(object, ...)"},{"path":"/reference/summary.epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for epichains class — summary.epichains","text":"object epichains object ... arguments passed methods","code":""},{"path":"/reference/summary.epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for epichains class — summary.epichains","text":"data frame information","code":""},{"path":"/reference/summary.epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary method for epichains class — summary.epichains","text":"James M. Azam","code":""},{"path":"/reference/tail.epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"tail method for epichains class — tail.epichains","title":"tail method for epichains class — tail.epichains","text":"tail method epichains class","code":""},{"path":"/reference/tail.epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"tail method for epichains class — tail.epichains","text":"","code":"# S3 method for epichains tail(x, ...)"},{"path":"/reference/tail.epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"tail method for epichains class — tail.epichains","text":"x epichains object ... arguments passed methods","code":""},{"path":"/reference/tail.epichains.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"tail method for epichains class — tail.epichains","text":"returns top rows epichains object. Note object originally sorted sim_id ancestor first unknown ancestors (NA) dropped printing method. view full output, use .data.frame(<object_name>).","code":""},{"path":"/reference/tail.epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tail method for epichains class — tail.epichains","text":"James M. Azam","code":""},{"path":"/reference/update_chain_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine and update the chain statistic being tracked — update_chain_stat","title":"Determine and update the chain statistic being tracked — update_chain_stat","text":"Determine update chain statistic tracked","code":""},{"path":"/reference/update_chain_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine and update the chain statistic being tracked — update_chain_stat","text":"","code":"update_chain_stat(stat_type, stat_latest, n_offspring)"},{"path":"/reference/update_chain_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine and update the chain statistic being tracked — update_chain_stat","text":"stat_type Chain statistic (size/length) update. stat_latest latest chain statistic vector updated. n_offspring vector offspring per chain.","code":""},{"path":"/reference/update_chain_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine and update the chain statistic being tracked — update_chain_stat","text":"vector chain statistics (size/length).","code":""},{"path":"/reference/validate_epichains.html","id":null,"dir":"Reference","previous_headings":"","what":"epichains class validator — validate_epichains","title":"epichains class validator — validate_epichains","text":"epichains class validator","code":""},{"path":"/reference/validate_epichains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"epichains class validator — validate_epichains","text":"","code":"validate_epichains(x)"},{"path":"/reference/validate_epichains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"epichains class validator — validate_epichains","text":"x epichains object","code":""},{"path":"/reference/validate_epichains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"epichains class validator — validate_epichains","text":"return.","code":""},{"path":"/reference/validate_epichains.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"epichains class validator — validate_epichains","text":"James M. Azam","code":""},{"path":[]},{"path":"/news/index.html","id":"package-name-change-0-1-0","dir":"Changelog","previous_headings":"","what":"Package name change","title":"epichains 0.1.0","text":"epichains re-implementation bpmodels focus providing dedicated class data structures easy manipulation interoperability new tools pipeline.","code":""},{"path":"/news/index.html","id":"functions-0-1-0","dir":"Changelog","previous_headings":"Package name change","what":"Functions","title":"epichains 0.1.0","text":"simulate_tree(): simulate transmission trees given number chains. simulate_tree_from_pop(): simulate transmission trees given population size initial immunity. simulate_summary(): simulate vector observed transmission chains sizes/lengths given number chains. likelihood(): estimate likelihood/loglikelihood observing chains given sizes/lengths.","code":""},{"path":"/news/index.html","id":"classes-0-1-0","dir":"Changelog","previous_headings":"Package name change","what":"Classes","title":"epichains 0.1.0","text":"chains: number chains simulated chains_tree, returned simulate_tree() simulate_tree_from_pop() chains_summary, returned simulate_summary(). track_pop: whether susceptible population tracked . chain_type: defined , aggregated_over: variable(s) aggregation done: “time”, “generation” “”. Useful easy plotting plot method (see methods section ).","code":""},{"path":"/news/index.html","id":"methods-0-1-0","dir":"Changelog","previous_headings":"Package name change","what":"Methods","title":"epichains 0.1.0","text":"print() summary() aggregate()","code":""}]
