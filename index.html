<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides methods to simulate and analyse the size and length
    of branching processes with an arbitrary offspring distribution. These
    can be used, for example, to analyse the distribution of chain sizes
    or length of infectious disease outbreaks, as discussed in Farrington
    et al. (2003) &lt;doi:10.1093/biostatistics/4.2.279&gt;.">
<title>Simulating and Analysing Transmission Chain Statistics Using Branching Process
    Models • epichains</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulating and Analysing Transmission Chain Statistics Using Branching Process
    Models">
<meta property="og:description" content="Provides methods to simulate and analyse the size and length
    of branching processes with an arbitrary offspring distribution. These
    can be used, for example, to analyse the distribution of chain sizes
    or length of infectious disease outbreaks, as discussed in Farrington
    et al. (2003) &lt;doi:10.1093/biostatistics/4.2.279&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">epichains</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/epichains.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Package vignettes</h6>
    <a class="dropdown-item" href="articles/projecting_incidence.html">Projecting infectious disease incidence: a COVID-19 example</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Modelling guides and background</h6>
    <a class="dropdown-item" href="articles/branching_process_literature.html">Literature on branching process applications</a>
    <a class="dropdown-item" href="articles/theoretical_background.html">Theoretical background for bpmodels</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/epichains/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="epichains-methods-for-simulating-and-analysing-the-size-and-length-of-transmission-chains-from-branching-process-models-">
<em>epichains</em>: Methods for simulating and analysing the size and length of transmission chains from branching process models <img src="reference/figures/epichains_logo.png" align="right" height="130"><a class="anchor" aria-label="anchor" href="#epichains-methods-for-simulating-and-analysing-the-size-and-length-of-transmission-chains-from-branching-process-models-"></a>
</h1></div>
<!-- badges: start -->

<p><em>epichains</em> is an R package to simulate, analyse, and visualize the size and length of branching processes with a given offspring distribution. These models are often used in infectious disease epidemiology, where the chains represent chains of transmission, and the offspring distribution represents the distribution of secondary infections caused by an infected individual.</p>
<p><em>epichains</em> re-implements <a href="%22https://github.com/epiverse-trace/bpmodels/%22" class="external-link">bpmodels</a> by providing dedicated data structures that allow easy manipulation and interoperability with other existing packages for handling transmission chain and contact-tracing data.</p>
<p><em>epichains</em> is developed at the <a href="https://www.lshtm.ac.uk/research/centres/centre-mathematical-modelling-infectious-diseases" class="external-link">Centre for the Mathematical Modelling of Infectious Diseases</a> at the London School of Hygiene and Tropical Medicine as part of the <a href="https://data.org/initiatives/epiverse/" class="external-link">Epiverse Initiative</a>.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>The latest development version of the <em>epichains</em> package can be installed via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check whether {pak} is installed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://pak.r-lib.org/" class="external-link">"pak"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"epiverse-trace/epichains"</span><span class="op">)</span></span></code></pre></div>
<p>To load the package, use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/epiverse-trace/epichains" class="external-link">"epichains"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h1>
<div class="section level2">
<h2 id="chain-likelihoods">Chain likelihoods<a class="anchor" aria-label="anchor" href="#chain-likelihoods"></a>
</h2>
<p><em>epichains</em> provides four main functions:</p>
<div class="section level3">
<h3 id="likelihood">
<a href="https://epiverse-trace.github.io/epichains/reference/likelihood.html"><code>likelihood()</code></a><a class="anchor" aria-label="anchor" href="#likelihood"></a>
</h3>
<p>This function calculates the likelihood/loglikelihood of observing a vector of outbreak summaries obtained from transmission chains. Summaries here refer to transmission chain sizes or lengths/durations.</p>
<p><code><a href="reference/likelihood.html">likelihood()</a></code> requires a vector of chain summaries (sizes or lengths), <code>chains</code>, the corresponding statistic to calculate, <code>statistic</code>, and the offspring distribution, <code>offspring_dist</code> its associated parameters. It also requires <code>nsim_obs</code>, which is the number of simulations to run if the likelihoods do not have a closed-form solution and must be simulated. This argument will be explained further in the <a href="https://epiverse-trace.github.io/epichains/articles/epichains.html">“Getting Started”</a> vignette.</p>
<p>Let’s look at the following example where we estimate the loglikelihood of observing <code>chain_sizes</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">121</span><span class="op">)</span></span>
<span><span class="co"># example of observed chain sizes</span></span>
<span><span class="co"># randomly generate 20 chains of size between 1 to 10</span></span>
<span><span class="va">chain_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate loglikelihood of the observed chain sizes</span></span>
<span><span class="va">likelihood_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/likelihood.html">likelihood</a></span><span class="op">(</span></span>
<span>  chains <span class="op">=</span> <span class="va">chain_sizes</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  nsim_obs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Print the estimate</span></span>
<span><span class="va">likelihood_eg</span></span>
<span><span class="co">#&gt; [1] -67.82879</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="chain-simulation">Chain simulation<a class="anchor" aria-label="anchor" href="#chain-simulation"></a>
</h2>
<p>There are three simulation functions, herein referred to colelctively as the <code>simulate_*()</code> functions. ``</p>
<div class="section level3">
<h3 id="simulate_tree">
<a href="https://epiverse-trace.github.io/epichains/reference/simulate_tree.html"><code>simulate_tree()</code></a><a class="anchor" aria-label="anchor" href="#simulate_tree"></a>
</h3>
<p><code><a href="reference/simulate_tree.html">simulate_tree()</a></code> simulates an outbreak from a given number of infections. It retains and returns information on infectors (ancestors), infectees, the generation of infection, and the time, if a serial distribution is specified.</p>
<p>Let’s look at an example where we simulate the transmission trees of <span class="math inline">10</span> initial infections/chains. We assume a poisson offspring distribution with mean, <span class="math inline">lambda = 0.9</span>, and a serial interval of <span class="math inline">3</span> days:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree.html">simulate_tree</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">3</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_tree_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt; tree head (from first known ancestor) &gt;</span></span>
<span><span class="co">#&gt;    chain_id sim_id ancestor generation time</span></span>
<span><span class="co">#&gt; 11        2      2        1          2    3</span></span>
<span><span class="co">#&gt; 13        3      2        1          2    3</span></span>
<span><span class="co">#&gt; 14        4      2        1          2    3</span></span>
<span><span class="co">#&gt; 16        5      2        1          2    3</span></span>
<span><span class="co">#&gt; 19        7      2        1          2    3</span></span>
<span><span class="co">#&gt; 20        8      2        1          2    3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate_summary">
<a href="https://epiverse-trace.github.io/epichains/reference/simulate_summary.html"><code>simulate_summary()</code></a><a class="anchor" aria-label="anchor" href="#simulate_summary"></a>
</h3>
<p><code><a href="reference/simulate_summary.html">simulate_summary()</a></code> is basically <code><a href="reference/simulate_tree.html">simulate_tree()</a></code> except that it does not retain information on each infector and infectee. It returns the eventual size or length/duration of each transmission chain.</p>
<p>Here is an example to simulate the previous examples without intervention, returning the size of each of the <span class="math inline">10</span> chains. It assumes a poisson offspring distribution with mean of <span class="math inline">0.9</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simulate_summary_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_summary.html">simulate_summary</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the results</span></span>
<span><span class="va">simulate_summary_eg</span></span>
<span><span class="co">#&gt; `epichains` object </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  [1]   1 Inf   4   4 Inf   1   2 Inf   5   3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Simulated chain sizes: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Max: 5</span></span>
<span><span class="co">#&gt; Min: 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate_tree_from_pop">
<a href="https://epiverse-trace.github.io/epichains/reference/simulate_tree_from_pop.html"><code>simulate_tree_from_pop()</code></a><a class="anchor" aria-label="anchor" href="#simulate_tree_from_pop"></a>
</h3>
<p><code><a href="reference/simulate_tree_from_pop.html">simulate_tree_from_pop()</a></code> simulates outbreaks based on a specified population size and pre-existing immunity until the susceptible pool runs out.</p>
<p>Here is a quick example where we simulate an outbreak in a population of size <span class="math inline">1000</span>. We assume individuals have a poisson offspring distribution with mean, <span class="math inline">lambda = 1</span>, and serial interval of <span class="math inline">3</span>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_from_pop_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree_from_pop.html">simulate_tree_from_pop</a></span><span class="op">(</span></span>
<span>  pop <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fl">3</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_tree_from_pop_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt; tree head (from first known ancestor) &gt;</span></span>
<span><span class="co">#&gt;   sim_id ancestor generation time</span></span>
<span><span class="co">#&gt; 2      2        1          2    3</span></span>
<span><span class="co">#&gt; 3      3        1          2    3</span></span>
<span><span class="co">#&gt; 4      4        1          2    3</span></span>
<span><span class="co">#&gt; 5      5        1          2    3</span></span>
<span><span class="co">#&gt; 6      6        2          3    6</span></span>
<span><span class="co">#&gt; 7      7        6          4    9</span></span></code></pre></div>
<div class="section level4">
<h4 id="simulating-interventions">Simulating interventions<a class="anchor" aria-label="anchor" href="#simulating-interventions"></a>
</h4>
<p>All the <code>simulate_*()</code> functions can model interventions that reduce the <span class="math inline"><em>R</em><sub>0</sub></span>, using the <code>intvn_mean_reduction</code> argument. In general, these can be interpreted as population-level interventions.</p>
<p>To illustrate this, we will use the previous examples for each function and specify a population-level intervention that reduces <span class="math inline"><em>R</em><sub>0</sub></span> by <span class="math inline">50%</span>.</p>
<p>Using <code><a href="reference/simulate_tree.html">simulate_tree()</a></code>, we can specify an initial number of cases and a population level intervention, <code>intvn_mean_reduction</code>, that reduces <span class="math inline"><em>R</em><sub>0</sub></span> by <span class="math inline">50%</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_intvn_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree.html">simulate_tree</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  intvn_mean_reduction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">3</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_tree_intvn_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt; tree head (from first known ancestor) &gt;</span></span>
<span><span class="co">#&gt;    chain_id sim_id ancestor generation time</span></span>
<span><span class="co">#&gt; 11        2      2        1          2    3</span></span>
<span><span class="co">#&gt; 12        4      2        1          2    3</span></span>
<span><span class="co">#&gt; 13        5      2        1          2    3</span></span>
<span><span class="co">#&gt; 15        8      2        1          2    3</span></span>
<span><span class="co">#&gt; 14        5      3        1          2    3</span></span>
<span><span class="co">#&gt; 16        2      3        2          3    6</span></span></code></pre></div>
<p>Here is an example with <code><a href="reference/simulate_summary.html">simulate_summary()</a></code>, modelling an intervention that reduces <span class="math inline"><em>R</em><sub>0</sub></span> by <span class="math inline">50%</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulate_summary_intvn_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_summary.html">simulate_summary</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  intvn_mean_reduction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the results</span></span>
<span><span class="va">simulate_summary_intvn_eg</span></span>
<span><span class="co">#&gt; `epichains` object </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  [1] 5 3 3 3 5 2 2 1 1 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Simulated chain sizes: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Max: 5</span></span>
<span><span class="co">#&gt; Min: 1</span></span></code></pre></div>
<p>Finally, let’s use <code><a href="reference/simulate_tree_from_pop.html">simulate_tree_from_pop()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_from_pop_intvn_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree_from_pop.html">simulate_tree_from_pop</a></span><span class="op">(</span></span>
<span>  pop <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  intvn_mean_reduction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fl">3</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_tree_from_pop_intvn_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt; tree head (from first known ancestor) &gt;</span></span>
<span><span class="co">#&gt;   sim_id ancestor generation time</span></span>
<span><span class="co">#&gt; 2      2        1          2    3</span></span>
<span><span class="co">#&gt; 3      3        1          2    3</span></span>
<span><span class="co">#&gt; 4      4        1          2    3</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="other-functionalities">Other functionalities<a class="anchor" aria-label="anchor" href="#other-functionalities"></a>
</h2>
<div class="section level3">
<h3 id="summarising">Summarising<a class="anchor" aria-label="anchor" href="#summarising"></a>
</h3>
<p>You can run <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on <code>&lt;epichains&gt;</code> objects to get useful summaries.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with simulate_tree()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree.html">simulate_tree</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">3</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_tree_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt; $chains_run</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_time</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $unique_ancestors</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_generation</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span></span>
<span><span class="co"># Example with simulate_summary()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simulate_summary_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_summary.html">simulate_summary</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get summaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simulate_summary_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt; $chains_run</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_chain_stat</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $min_chain_stat</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aggregating">Aggregating<a class="anchor" aria-label="anchor" href="#aggregating"></a>
</h3>
<p>You can aggregate <code>&lt;epichains&gt;</code> objects returned by the <code>simulate_*()</code> functions into a time series, which is a <code>&lt;data.frame&gt;</code> with columns “cases” and either “generation” or “time”, depending on the value of <code>grouping_var</code>.</p>
<p>To aggregate over “time”, you must have specified a serial interval distribution in the simulation step.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with simulate_tree()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree.html">simulate_tree</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">3</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">sim_tree_eg</span>, grouping_var <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time cases</span></span>
<span><span class="co">#&gt; 1    0    10</span></span>
<span><span class="co">#&gt; 2    3    13</span></span>
<span><span class="co">#&gt; 3    6    15</span></span>
<span><span class="co">#&gt; 4    9    18</span></span>
<span><span class="co">#&gt; 5   12     2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<p>Aggregated <code>&lt;epichains&gt;</code> objects can easily be plotted using base R or <code>ggplot2</code> with little to no data manipulation.</p>
<p>Here is an end-to-end example from simulation through aggregation to plotting.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run simulation with simulate_tree()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_tree_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_tree.html">simulate_tree</a></span><span class="op">(</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>  stat_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  serials_dist <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">3</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggregate cases over time</span></span>
<span><span class="va">sim_aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">sim_tree_eg</span>, grouping_var <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot cases over time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_aggreg</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="package-vignettes">Package vignettes<a class="anchor" aria-label="anchor" href="#package-vignettes"></a>
</h2>
<p>Specific use cases of <em>epichains</em> can be found in the <a href="https://epiverse-trace.github.io/epichains/">online documentation as package vignettes</a>, under “Articles”.</p>
</div>
<div class="section level2">
<h2 id="reporting-bugs">Reporting bugs<a class="anchor" aria-label="anchor" href="#reporting-bugs"></a>
</h2>
<p>To report a bug please open an <a href="https://github.com/epiverse-trace/epichains/issues/new/choose" class="external-link">issue</a>.</p>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>We welcome contributions to enhance the package’s functionalities. If you wish to do so, please follow the <a href="https://github.com/epiverse-trace/epichains/blob/main/.github/CONTRIBUTING.md" class="external-link">package contributing guide</a>.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <em>epichains</em> project is released with a <a href="https://github.com/epiverse-trace/.github/blob/main/CODE_OF_CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="citing-this-package">Citing this package<a class="anchor" aria-label="anchor" href="#citing-this-package"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"epichains"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite package epichains in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Sebastian Funk, Flavio Finger, and James M. Azam (2023). epichains:</span></span>
<span><span class="co">#&gt;   Analysing transmission chain statistics using branching process</span></span>
<span><span class="co">#&gt;   models, website: https://github.com/epiverse-trace/epichains/</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Manual{,</span></span>
<span><span class="co">#&gt;     title = {epichains: Analysing transmission chain statistics using branching process models},</span></span>
<span><span class="co">#&gt;     author = {{Sebastian Funk} and {Flavio Finger} and {James M. Azam}},</span></span>
<span><span class="co">#&gt;     year = {2023},</span></span>
<span><span class="co">#&gt;     url = {https://github.com/epiverse-trace/epichains/},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiverse-trace/epichains/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/epiverse-trace/epichains/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="code-of-conduct">
<h2 data-toc-skip>Code of Conduct</h2>
<ul class="list-unstyled">
<li>
<p><a href="https://docs.google.com/document/d/e/2PACX-1vSi9qlNRvh6nSSlHEcM8mpB9XQHDQyo2I12VG--r5SwciJ5UdRzhUp3sYXJhXoyYg/pub" class="external-link">Código de Conducta</a></p>
<p><a href="https://docs.google.com/document/u/1/d/e/2PACX-1vRcwl2uaKdEQT5iS-9MroDMKsd81oR8v1gdlY1kHTTjgGEbLKfcWxtdrkvVRhJJGQalsgC1A4K4YiDe/pub" class="external-link">Code of Conduct</a></p>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing epichains</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>James M. Azam <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0001-5782-7330" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Flavio Finger <br><small class="roles"> Author </small> <a href="https://orcid.org/https://orcid.org/0000-0002-8613-5170" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sebastian Funk <br><small class="roles"> Author </small> <a href="https://orcid.org/https://orcid.org/0000-0002-2842-3406" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by James M. Azam, Flavio Finger, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
